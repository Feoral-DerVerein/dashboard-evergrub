# Negentropy AI - Environment Variables

## Frontend (.env)
VITE_SUPABASE_PROJECT_ID="jiehjbbdeyngslfpgfnt"
VITE_SUPABASE_PUBLISHABLE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImppZWhqYmJkZXluZ3NsZnBnZm50Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA3NDQxNzAsImV4cCI6MjA1NjMyMDE3MH0.s2152q-oy3qBMsJmVQ8-L9whBQDjebEQSo6GVYhXtlg"
VITE_SUPABASE_URL="https://jiehjbbdeyngslfpgfnt.supabase.co"

## Backend Edge Functions (.env.local or Supabase Secrets)

# LLM Configuration (Aladdin AI)
# Choose ONE provider - the system will auto-detect based on which key is set
# RECOMMENDED: Use Gemini Flash for best cost efficiency!

GEMINI_API_KEY="..." # Google Gemini API key (RECOMMENDED - cheapest option!)
# OR
OPENAI_API_KEY="sk-..." # OpenAI API key
# OR
ANTHROPIC_API_KEY="sk-ant-..." # Anthropic API key

# Optional: Explicitly set provider and model
LLM_PROVIDER="gemini" # or "openai" or "anthropic"
LLM_MODEL="gemini-1.5-flash-latest" # or "gpt-4o-mini" or "claude-3-5-sonnet-20241022"

# ML Service (Optional - for advanced forecasting)
ML_SERVICE_URL="http://localhost:8000" # URL to Python ML service if using custom models

# Weather Integration
OPENWEATHER_API_KEY="..." # OpenWeatherMap API key for weather data

# Macroeconomic Indicators (TODO: B. Macro Module)
INE_API_KEY="..." # Spanish National Statistics Institute API key
EUROSTAT_API_KEY="..." # Eurostat API key (may be public, verify)

# POS Integrations
SQUARE_ACCESS_TOKEN="..." # Square POS access token
DELIVERECT_API_KEY="..." # Deliverect API key

## ðŸ’° Cost Comparison

| Provider | Model | Input ($/1M tokens) | Output ($/1M tokens) | Monthly Cost (100 queries/day) |
|----------|-------|---------------------|----------------------|-------------------------------|
| **Google Gemini** | gemini-1.5-flash-latest | $0.075 | $0.30 | **~$2.50/month** âœ… CHEAPEST |
| Google Gemini | gemini-1.5-pro-latest | $1.25 | $5.00 | ~$40/month |
| OpenAI | gpt-4o-mini | $0.150 | $0.60 | ~$5/month |
| OpenAI | gpt-4o | $2.50 | $10.00 | ~$80/month |
| Anthropic | claude-3-5-sonnet | $3.00 | $15.00 | ~$100/month |

**âœ¨ Recommendation: Use Gemini 1.5 Flash for excellent quality at the lowest cost!**

## How to Get API Keys

### Google Gemini (RECOMMENDED)
1. Go to: https://makersuite.google.com/app/apikey
2. Or: https://aistudio.google.com/app/apikey
3. Click "Get API Key" â†’ "Create API Key"
4. Copy the key (starts with `AI...`)
5. **Free tier includes**: 60 requests per minute, 1,500 requests per day

### OpenAI
1. Go to: https://platform.openai.com/api-keys
2. Create new secret key
3. Copy the key (starts with `sk-...`)
4. **Note**: Requires credit card, no free tier

### Anthropic
1. Go to: https://console.anthropic.com/
2. Settings â†’ API Keys
3. Create key
4. **Note**: $5 minimum credit required

## How to Set Supabase Secrets

### Using Supabase CLI:

```bash
# Recommended: Gemini (cheapest)
supabase secrets set GEMINI_API_KEY=YOUR_KEY_HERE

# Or OpenAI
supabase secrets set OPENAI_API_KEY=sk-...

# Or Anthropic
supabase secrets set ANTHROPIC_API_KEY=sk-ant-...

# Optional: specify provider explicitly
supabase secrets set LLM_PROVIDER=gemini

# Or set from .env.local file
supabase secrets set --env-file .env.local
```

### Using Supabase Dashboard:

1. Go to Project Settings > Edge Functions
2. Add secrets in the "Secrets" section
3. Secrets are encrypted and only accessible to Edge Functions

## Recommended Configuration

### For Production (Best Value):
```bash
GEMINI_API_KEY=AI...  # Your Gemini API key
LLM_PROVIDER=gemini
LLM_MODEL=gemini-1.5-flash-latest
```
- **Cost**: ~$2.50/month for 100 queries/day
- **Quality**: Excellent (comparable to GPT-4o-mini)
- **Speed**: Fast
- **Free tier**: 1,500 requests/day

### For Maximum Quality:
```bash
GEMINI_API_KEY=AI...
LLM_PROVIDER=gemini
LLM_MODEL=gemini-1.5-pro-latest
```
- **Cost**: ~$40/month for 100 queries/day
- **Quality**: Best-in-class (comparable to GPT-4o)

### For Development (Local Testing):
Use Gemini Flash for fast, cheap iteration with generous free tier.

## Cost Monitoring

The LLM client automatically tracks token usage and estimates costs.
View logs in Supabase Dashboard > Edge Functions > Logs.

### Average query cost estimates with Gemini Flash:

| Query Type | Avg Tokens | Cost |
|------------|------------|------|
| Simple inventory question | ~500 | **$0.0002** |
| Complex analysis with context | ~2,000 | **$0.0008** |
| Prevention plan generation | ~3,000 | **$0.0012** |

### Expected monthly costs (Gemini Flash):

**Light Usage** (10 queries/day): **~$0.25/month**  
**Medium Usage** (50 queries/day): **~$1.25/month**  
**Heavy Usage** (200 queries/day): **~$5/month**

**Even with heavy usage, Gemini Flash costs less than $5/month!** ðŸŽ‰

## Security Notes

- **NEVER commit API keys to git**
- Use `.env.local` for local development (add to `.gitignore`)
- Use Supabase Secrets for production
- Rotate keys regularly
- Gemini API has built-in rate limiting (60 req/min free tier)

## Migration from OpenAI/Anthropic

If you're already using OpenAI or Anthropic, migrating to Gemini is zero-code:

1. Get Gemini API key
2. Add to Supabase: `supabase secrets set GEMINI_API_KEY=AI...`
3. Redeploy: `supabase functions deploy aladdin-ai`
4. Done! The client automatically uses Gemini

The system will automatically prefer Gemini if the key is present.
